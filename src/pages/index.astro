---
import {getCollection} from "astro:content";

import SectionStage from "@/components/section-stage.astro";
import SectionCta from "@/components/sections/section-cta.astro";
import SectionStageContentIntro from "@/components/section-stage-content-intro.astro";
import SectionConnect from "@/components/sections/section-connect.astro";
import SectionTestimonials from "@/components/sections/section-testimonials.astro";
import SectionServices from "@/components/sections/section-services.astro";
import SectionProjects from "@/components/sections/section-projects.astro";
import {sortByOrderProp} from "@/helpers/misc-helpers";
import Layout from "@/layouts/main.astro";

import me from "@/content/me.json" assert {type: "json"};
import cv from "@/content/cv.json" assert {type: "json"};

const services = await getCollection("services").then(sortByOrderProp("asc"));
const projects = await getCollection("projects").then(sortByOrderProp("desc"));
const testimonials = await getCollection("testimonials").then(sortByOrderProp("asc"));
---

<Layout
    slug="/"
    title={`${me.name} | full-stack developer`}
    description={`Freelance full-stack developer building web apps and enterprise websites preferably with React, Next.js and Node.js.`}
>
    <SectionStage>
        <SectionStageContentIntro />
    </SectionStage>

    <SectionServices id="services" headline="my services" subline="Here's what I can do for you 🧑🏻‍💻" services={services} />

    <SectionProjects
        id="projects"
        headline="Projects"
        subline="Curious about what I can deliver? Explore a selection of projects I've worked on."
        projects={projects}
    />

    <SectionCta
        id="dev-support"
        headline="Need dev support?"
        message="Let me help you creating high-quality digital products."
        ctas={[
            {
                trackingEvent: {action: "click", category: "cta_email", name: "cta_email_section-cta-dev-support"},
                href: `mailto:${me.email}`,
                text: "send me an email",
                class: "btn-accent",
            },
        ]}
    />

    <SectionTestimonials headline="Testimonials" testimonials={testimonials} />

    <SectionConnect
        headline="Let's connect!"
        subline="Download my CV and connect with me on other online platforms."
        resources={[
            {
                title: "CV",
                description: "Download my up-to-date CV.",
                link: {href: cv.href, target: "_blank"},
                iconId: "document",
            },
            {
                title: "Email",
                description: "Let's get in touch!",
                link: {href: `mailto:${me.email}`},
                iconId: "envelope",
            },
            {
                title: "LinkedIn",
                description: "I share insights about my work here every now and then.",
                link: {href: me.socials.linkedin, target: "_blank"},
                iconId: "linkedin",
            },
            {
                title: "Instagram",
                description: "If you're interested in my personal life → I'm an open book ;)",
                link: {href: me.socials.instagram, target: "_blank"},
                iconId: "instagram",
            },
        ]}
    />

    <SectionCta
        id="thanks"
        headline="Thanks for visiting!"
        message="If you want to collaborate don't hestiate to..."
        ctas={[
            {
                trackingEvent: {action: "click", category: "cta_email", name: "cta_email_section-cta-thanks"},
                href: `mailto:${me.email}`,
                text: "send me an email",
                class: "btn-accent",
            },
        ]}
    />
</Layout>
